(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-41044a34"],{"026f":function(t,e,n){"use strict";n("3e3f")},"0eec":function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"reactive-container"},[n("div",{staticClass:"form-container",staticStyle:{padding:"20px 0px"}},[n("el-form",{ref:"formData",attrs:{model:t.formData,"status-icon":"",rules:t.rules,"label-width":"150px"}},[n("el-form-item",{attrs:{label:"Job Type",prop:"type"}},[n("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"Please select job type"},on:{change:function(e){return t.initForm()}},model:{value:t.formData.type,callback:function(e){t.$set(t.formData,"type",e)},expression:"formData.type"}},t._l(t.jobToDbTypeMap,(function(t,e){return n("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1),n("el-form-item",{attrs:{label:"Worker",prop:"routeUrl"}},[n("el-select",{staticStyle:{width:"100%"},attrs:{multiple:""},model:{value:t.formData.routeUrl,callback:function(e){t.$set(t.formData,"routeUrl",e)},expression:"formData.routeUrl"}},t._l(t.routeUrlList,(function(e){return n("el-option",{key:e.id,attrs:{label:e.name,value:e.id}},[n("span",{staticStyle:{float:"left"}},[t._v(t._s(e.name))]),n("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[t._v(t._s(e.ip))])])})),1)],1),"FLINK_SQL"===t.formData.type?[n("el-form-item",{attrs:{label:"Version",prop:"version"}},[n("el-select",{staticStyle:{width:"100%"},model:{value:t.formData.version,callback:function(e){t.$set(t.formData,"version",e)},expression:"formData.version"}},t._l(t.versionList,(function(t){return n("el-option",{key:t,attrs:{label:t,value:t}})})),1)],1),n("el-form-item",{attrs:{label:"Execution Mode",prop:"execMode"}},[n("el-select",{staticStyle:{width:"100%"},model:{value:t.formData.execMode,callback:function(e){t.$set(t.formData,"execMode",e)},expression:"formData.execMode"}},t._l(t.execModeList,(function(t){return n("el-option",{key:t,attrs:{label:t,value:t}})})),1)],1),n("el-form-item",{attrs:{label:"Deploy Mode",prop:"deployMode"}},[n("el-select",{staticStyle:{width:"100%"},model:{value:t.formData.deployMode,callback:function(e){t.$set(t.formData,"deployMode",e)},expression:"formData.deployMode"}},t._l(t.deployModeList,(function(t){return n("el-option",{key:t,attrs:{label:t,value:t}})})),1)],1),n("el-form-item",{attrs:{label:"Catalogs",prop:"catalogs"}},[n("el-select",{staticStyle:{width:"100%"},attrs:{multiple:""},model:{value:t.formData.config.catalogs,callback:function(e){t.$set(t.formData.config,"catalogs",e)},expression:"formData.config.catalogs"}},t._l(t.catalogList,(function(e){return n("el-option",{key:e.id,attrs:{label:e.name,value:e.id}},[n("span",{staticStyle:{float:"left"}},[t._v(t._s(e.name))]),n("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[t._v(t._s(e.description))])])})),1)],1),n("el-form-item",{attrs:{label:"External Jars",prop:"extJars"}},[n("el-select",{staticStyle:{width:"100%"},attrs:{multiple:""},model:{value:t.formData.config.extJars,callback:function(e){t.$set(t.formData.config,"extJars",e)},expression:"formData.config.extJars"}},t._l(t.extJarList,(function(e){return n("el-option",{key:e.id,attrs:{label:e.name,value:e.id}},[n("span",{staticStyle:{float:"left"}},[t._v(t._s(e.name))]),n("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[t._v(t._s(e.description))])])})),1)],1)]:t._e(),"CLICKHOUSE_SQL"===t.formData.type||"MYSQL_SQL"===t.formData.type||"HIVE_SQL"===t.formData.type?[n("el-form-item",{attrs:{label:"DataSource",prop:"config.dsId"}},[n("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"Please select data source"},model:{value:t.formData.config.dsId,callback:function(e){t.$set(t.formData.config,"dsId",e)},expression:"formData.config.dsId"}},t._l(t.dataSourceList,(function(t){return n("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)],1)]:t._e(),n("el-form-item",{attrs:{label:"SQL",prop:"subject"}},[n("CodeEditor",{ref:"codeEditor",attrs:{value:t.formData.subject,mode:"text/x-hive"},on:{"update:value":function(e){return t.$set(t.formData,"subject",e)},changeTextarea:function(e){return t.changeTextarea(e)}}})],1),n("el-form-item",[n("el-button",{attrs:{type:"primary"},on:{click:function(e){return e.stopPropagation(),t.submitForm()}}},[t._v("Execution")]),n("el-button",{attrs:{type:"success",plain:""},on:{click:function(e){return t.formatSql()}}},[t._v("Format SQL")])],1)],2)],1),t.execId?n("div",[n("el-divider",{attrs:{"content-position":"left"}},[n("el-link",{attrs:{type:"danger"}},[t._v("execution_id: "+t._s(t.execId))])],1)],1):t._e(),t.tableHeader||t.tableData?n("el-table",{staticStyle:{width:"100%"},attrs:{border:"",stripe:"",size:"small",data:t.tableData}},[t._l(t.tableHeader,(function(e,a){return[n("el-table-column",{key:a,attrs:{prop:e,label:e},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t.tableData[e.$index][a])+" ")]}}],null,!0)})]}))],2):t._e(),t.exception||t.execLog?n("pre",[t._v(t._s(t.exception)+" "+t._s(t.execLog))]):t._e()],1)},r=[],o=n("5530"),i=n("3a3d"),c=n("b775");function u(){return Object(c["a"])({url:"/reactive/jobToDbTypes",method:"get"}).then((function(t){return t.data}))}function s(t){return Object(c["a"])({url:"/reactive/execJob",method:"post",data:t}).then((function(t){return t.data}))}function l(t,e){return Object(c["a"])({url:"/reactive/execLog/".concat(t),method:"get",params:e}).then((function(t){return t.data}))}var d=n("b964"),f=n("6c6e"),m=n("7fbc"),p=n("c24f"),h=n("d175"),b={name:"Reactive",components:{CodeEditor:i["a"]},data:function(){return{jobToDbTypeMap:{},routeUrlList:[],versionList:[],deployModeList:[],execModeList:[],catalogList:[],extJarList:[],dataSourceList:[],timer:void 0,execId:null,execLog:"",tableHeader:[],tableData:[],exception:null,formData:{config:{}},rules:{type:[{required:!0,message:"Please select job type",trigger:"blur"}],routeUrl:[{required:!0,message:"Please select worker",trigger:"blur"}],subject:[{required:!0,message:"Please enter content",trigger:"change"}],"config.dsId":[{required:!0,message:"Please choose data source",trigger:"change"}]}}},created:function(){this.initJobToDbTypes(),this.initRouteUrlList()},beforeDestroy:function(){clearInterval(this.timer)},methods:{initJobToDbTypes:function(){var t=this;u().then((function(e){t.jobToDbTypeMap=e}))},initRouteUrlList:function(){var t=this;Object(p["e"])().then((function(e){t.routeUrlList=e}))},initForm:function(){var t=this;this.resetForm();var e=this.formData.type;"FLINK_SQL"===e&&(this.initVersionList("FLINK"),this.initDeployModeList("FLINK"),this.execModeList=["STREAMING","BATCH"],this.getCatalogList(),this.getExtJarList());var n=this.jobToDbTypeMap[e];n?Object(d["d"])({dbType:n}).then((function(e){t.dataSourceList=e})):this.dataSourceList=[]},initVersionList:function(t){var e=this;Object(m["h"])(t).then((function(t){e.versionList=t}))},initDeployModeList:function(t){var e=this;Object(m["b"])(t).then((function(t){e.deployModeList=t}))},getCatalogList:function(){var t=this;Object(h["e"])().then((function(e){t.catalogList=e}))},getExtJarList:function(){var t=this;Object(f["e"])({type:"JAR"}).then((function(e){t.extJarList=e}))},appendExecLog:function(){var t,e=this,n=null===(t=this.formData.routeUrl)||void 0===t?void 0:t[0];l(this.execId,{worker:n}).then((function(t){e.execLog=e.execLog+t.log,t.remain||clearInterval(e.timer)}))},submitForm:function(){var t=this;this.$refs["formData"].validate((function(e){if(!e)return console.log("error submit!!"),!1;t.formData.config.type=t.formData.type,s(t.formData).then((function(e){t.resetResult(),e.sync?(t.execId=e.execId,t.tableHeader=e.meta,t.tableData=e.data,t.exception=e.exception):(t.execId=e.execId,t.timer=setInterval((function(){setTimeout(t.appendExecLog,0)}),3e3))}))}))},changeTextarea:function(t){this.$set(this.formData,"subject",t)},formatSql:function(){this.$refs.codeEditor.format()},resetForm:function(){var t=this.formData.subject,e=this.formData.type,n={config:{}};this.formData=Object(o["a"])(Object(o["a"])({},n),{},{subject:t,type:e})},resetResult:function(){clearInterval(this.timer),this.timer=void 0,this.execId=null,this.execLog="",this.tableHeader=[],this.tableData=[],this.exception=null}}},g=b,v=(n("026f"),n("2877")),y=Object(v["a"])(g,a,r,!1,null,"543ca8db",null);e["default"]=y.exports},"1a26":function(t,e,n){"use strict";n("1e66")},"1e66":function(t,e,n){},"3a3d":function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"code-area"},[n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.value,expression:"value"}],ref:"codeText",attrs:{disabled:t.readOnly},domProps:{value:t.value},on:{input:function(e){e.target.composing||(t.value=e.target.value)}}})])},r=[],o=n("db05"),i=(n("0f7c"),n("a7be"),n("f6b6"),n("56b3"));n("8c33"),n("31c5"),n("ffda"),n("9b74"),n("991c"),n("02f0");var c={name:"CodeEditor",props:{mode:{type:String,default:""},value:{type:String,default:""},readOnly:{type:Boolean}},data:function(){return{sqlData:null}},computed:{newVal:function(){return this.sqlData?this.sqlData.getValue():""}},watch:{newVal:function(t,e){this.sqlData&&this.$emit("changeTextarea",this.sqlData.getValue())}},mounted:function(){var t=this;this.sqlData=i.fromTextArea(this.$refs.codeText,{value:this.value,mode:this.mode,indentWithTabs:!0,smartIndent:!0,lineNumbers:!0,matchBrackets:!0,cursorHeight:1,lineWrapping:!0,readOnly:this.readOnly,extraKeys:{Ctrl:"autocomplete"},hintOptions:{completeSingle:!1}}),this.sqlData.on("inputRead",(function(){t.sqlData.showHint()}))},methods:{setVal:function(t){this.sqlData.setValue(t)},format:function(){var t=this.getLangFormatOption(),e=Object(o["format"])(this.sqlData.getValue(),{language:t});this.sqlData.setValue(e)},getLangFormatOption:function(){switch(this.mode){case"text/x-sh":return"";case"text/x-sql":return"sql";case"text/x-hive":default:return"spark"}}}},u=c,s=(n("1a26"),n("2877")),l=Object(s["a"])(u,a,r,!1,null,null,null);e["a"]=l.exports},"3e3f":function(t,e,n){},"6c6e":function(t,e,n){"use strict";n.d(e,"d",(function(){return r})),n.d(e,"g",(function(){return o})),n.d(e,"f",(function(){return i})),n.d(e,"e",(function(){return c})),n.d(e,"a",(function(){return u})),n.d(e,"h",(function(){return s})),n.d(e,"c",(function(){return l})),n.d(e,"b",(function(){return d}));var a=n("b775");function r(t){return Object(a["a"])({url:"/resource/get/".concat(t),method:"get"}).then((function(t){return t.data}))}function o(t){return Object(a["a"])({url:"/resource/getWithParents/".concat(t),method:"get"}).then((function(t){return t.data}))}function i(t){return Object(a["a"])({url:"/resource/page",method:"get",params:t}).then((function(t){return t.data}))}function c(t){return Object(a["a"])({url:"/resource/list",method:"get",params:t}).then((function(t){return t.data}))}function u(t){return Object(a["a"])({url:"/resource/create",method:"post",data:t}).then((function(t){return t.data}))}function s(t){return Object(a["a"])({url:"/resource/update",method:"post",data:t}).then((function(t){return t.data}))}function l(t){return Object(a["a"])({url:"/resource/delete/".concat(t),method:"get"}).then((function(t){return t.data}))}function d(t){return Object(a["a"])({url:"/resource/deleteFile",method:"post",data:t}).then((function(t){return t.data}))}},"7fbc":function(t,e,n){"use strict";n.d(e,"c",(function(){return i})),n.d(e,"e",(function(){return c})),n.d(e,"d",(function(){return u})),n.d(e,"b",(function(){return l})),n.d(e,"g",(function(){return d})),n.d(e,"h",(function(){return f})),n.d(e,"f",(function(){return m})),n.d(e,"a",(function(){return p}));var a=n("c7eb"),r=n("1da1"),o=n("b775");function i(t){return Object(o["a"])({url:"/attr/edgeStates?jobId=".concat(t),method:"get"}).then((function(t){return t.data}))}function c(t){return Object(o["a"])({url:"/attr/nodeTypes?type=".concat(t),method:"get"}).then((function(t){return t.data}))}function u(t){return s.apply(this,arguments)}function s(){return s=Object(r["a"])(Object(a["a"])().mark((function t(e){return Object(a["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(o["a"])({url:"/attr/nodeClassification?jobType=".concat(e),method:"get"}).then((function(t){return t.data}));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),s.apply(this,arguments)}function l(t){return Object(o["a"])({url:"/attr/deployModes?type=".concat(t),method:"get"}).then((function(t){return t.data}))}function d(t){return Object(o["a"])({url:"/attr/enums",method:"get",params:t}).then((function(t){return t.data}))}function f(t){return Object(o["a"])({url:"/attr/versions?type=".concat(t),method:"get"}).then((function(t){return t.data}))}function m(){return Object(o["a"])({url:"/attr/preconditions",method:"get"}).then((function(t){return t.data}))}function p(){return Object(o["a"])({url:"/attr/dependentRelations",method:"get"}).then((function(t){return t.data}))}},b964:function(t,e,n){"use strict";n.d(e,"c",(function(){return r})),n.d(e,"e",(function(){return o})),n.d(e,"d",(function(){return i})),n.d(e,"a",(function(){return c})),n.d(e,"g",(function(){return u})),n.d(e,"b",(function(){return s})),n.d(e,"f",(function(){return l}));var a=n("b775");function r(t){return Object(a["a"])({url:"/datasource/get/".concat(t),method:"get"}).then((function(t){return t.data}))}function o(t){return Object(a["a"])({url:"/datasource/page",method:"get",params:t}).then((function(t){return t.data}))}function i(t){return Object(a["a"])({url:"/datasource/list",method:"get",params:t}).then((function(t){return t.data}))}function c(t){return Object(a["a"])({url:"/datasource/create",method:"post",data:t}).then((function(t){return t.data}))}function u(t){return Object(a["a"])({url:"/datasource/update",method:"post",data:t}).then((function(t){return t.data}))}function s(t){return Object(a["a"])({url:"/datasource/delete/".concat(t),method:"get"}).then((function(t){return t.data}))}function l(t){return Object(a["a"])({url:"/datasource/test/".concat(t),method:"get"}).then((function(t){return t.data}))}},d175:function(t,e,n){"use strict";n.d(e,"c",(function(){return r})),n.d(e,"d",(function(){return o})),n.d(e,"e",(function(){return i})),n.d(e,"a",(function(){return c})),n.d(e,"f",(function(){return u})),n.d(e,"b",(function(){return s}));var a=n("b775");function r(t){return Object(a["a"])({url:"/catalog/get/".concat(t),method:"get"}).then((function(t){return t.data}))}function o(t){return Object(a["a"])({url:"/catalog/page",method:"get",params:t}).then((function(t){return t.data}))}function i(){return Object(a["a"])({url:"/catalog/list",method:"get"}).then((function(t){return t.data}))}function c(t){return Object(a["a"])({url:"/catalog/create",method:"post",data:t}).then((function(t){return t.data}))}function u(t){return Object(a["a"])({url:"/catalog/update",method:"post",data:t}).then((function(t){return t.data}))}function s(t){return Object(a["a"])({url:"/catalog/delete/".concat(t),method:"get"}).then((function(t){return t.data}))}}}]);